import{I as A,f}from"./icon-676WNKtW.js";import{p as d,q as g,j as h,i as m,B as E,h as l,t as v}from"./constants-vbOiYBmn.js";import{t as S,F as p,B as T}from"./index-JD1MY5Ff.js";import{a as y,b as L}from"./state-layer-CPaTwDMH.js";function O(){return new Promise(o=>setTimeout(o))}const I=["name","value","formaction","formenctype","formmethod","formnovalidate","formtarget"];function P(o,t,s){s.forEach(e=>{const i=o.getAttribute(e);i!==null&&t.setAttribute(e,i)})}const b={TYPE:"type",DISABLED:"disabled",POPOVER_ICON:"popover-icon",DENSE:"dense",TABINDEX:"tabindex"},k={...b},D={ROOT:"forge-button",POPOVER_ICON:"forge-button__popover-icon",WITH_ANCHOR:"with-anchor"},C={ROOT:"[part=root]",DEFAULT_SLOT:"slot:not([name])",END_SLOT:"slot[name=end]"},n={observedAttributes:b,attributes:k,selectors:C,classes:D};function N(o){class t extends o{}return t}function w(o){class t extends o{constructor(...e){super(...e),this[d]=this.attachInternals()}}return t}/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 * 
 * Adapted and influenced from [Material Web](https://github.com/material-components/material-web).
 * The original source code can be found at: [GitHub](https://github.com/material-components/material-web/blob/main/internal/aria/aria.ts)
 */function B(o){return o.replace("aria","aria-").replace(/Elements?/g,"").toLowerCase()}function H(o,t,s,{setAttribute:e}={setAttribute:!0}){Object.entries(s).forEach(([i,r])=>{g()&&(t[i]=r);const a=B(i);(e||!o.hasAttribute(a))&&S(o,r!=null,a,r)})}function R(o){class t extends o{[h](e,i){H(this,this[d],e,i)}}return t}var x=Object.defineProperty,u=(o,t,s,e)=>{for(var i=void 0,r=o.length-1,a;r>=0;r--)(a=o[r])&&(i=a(t,s,i)||i);return i&&x(t,s,i),i};const _=class _ extends R(w(N(E))){constructor(){super(),this.popoverTargetElement=null,this.popoverTargetAction="click",A.define(f)}static get observedAttributes(){return Object.values(n.observedAttributes)}connectedCallback(){this._foundation.initialize()}attributeChangedCallback(t,s,e){switch(t){case n.observedAttributes.TYPE:this.type=e;return;case n.observedAttributes.DISABLED:this.disabled=m(e);return;case n.observedAttributes.POPOVER_ICON:this.popoverIcon=m(e);return;case n.observedAttributes.DENSE:this.dense=m(e);return}}labelClickedCallback(){this._foundation.click({animateStateLayer:!0})}labelChangedCallback(t){this[h]({ariaLabel:t},{setAttribute:!this.hasAttribute("aria-label")})}get form(){return this[d].form}get name(){return this.getAttribute("name")??""}set name(t){this.setAttribute("name",t)}get value(){return this.getAttribute("value")??""}set value(t){this.setAttribute("value",t)}click(){this._foundation.click({animateStateLayer:!0})}focus(t){this._foundation.focus(t)}};_.formAssociated=!0;let c=_;u([p()],c.prototype,"type");u([p()],c.prototype,"disabled");u([p()],c.prototype,"popoverIcon");u([p()],c.prototype,"dense");class W{constructor(t){this._adapter=t,this._type="button",this._disabled=!1,this._popoverIcon=!1,this._dense=!1,this._clickListener=this._onClick.bind(this),this._keydownListener=this._onKeydown.bind(this),this._slotChangeListener=()=>this._detectSlottedAnchor()}initialize(){this._detectSlottedAnchor(),this._adapter.addDefaultSlotChangeListener(this._slotChangeListener)}click({animateStateLayer:t=!1}={}){this._disabled||(this._adapter.clickHost(),t&&this._adapter.animateStateLayer())}focus(t){this._adapter.focusHost(t),(t==null?void 0:t.focusVisible)!==!1&&this._adapter.forceFocusVisible()}async _onClick(t){const s=this._type==="submit"||this._type==="reset";!s&&this._adapter.hasPopoverTarget()&&this._adapter.managePopover()||(await new Promise(e=>setTimeout(e)),!(t.defaultPrevented||this._disabled)&&s&&this._adapter.clickFormButton(this._type))}async _onKeydown(t){if(t.key===" "){t.preventDefault(),this.click();return}await O(),!(t.defaultPrevented||this._disabled)&&t.key==="Enter"&&this.click()}_detectSlottedAnchor(){this._adapter.hasSlottedAnchor?(this.disabled=!1,this._adapter.removeHostListener("click",this._clickListener),this._adapter.removeHostListener("keydown",this._keydownListener)):(this._adapter.addHostListener("click",this._clickListener),this._adapter.addHostListener("keydown",this._keydownListener)),this._adapter.initialize()}get type(){return this._type}set type(t){this._type!==t&&(this._type=t,this._adapter.setHostAttribute(n.attributes.TYPE,t))}get disabled(){return this._disabled}set disabled(t){t=!!t,this._disabled!==t&&(this._adapter.hasSlottedAnchor&&(t=!1),this._disabled=t,this._adapter.setDisabled(this._disabled),this._adapter.toggleHostAttribute(n.attributes.DISABLED,t))}get popoverIcon(){return this._popoverIcon}set popoverIcon(t){t=!!t,this._popoverIcon!==t&&(this._popoverIcon=t,this._adapter.toggleDefaultPopoverIcon(this._popoverIcon),this._adapter.toggleHostAttribute(n.attributes.POPOVER_ICON,t))}get dense(){return this._dense}set dense(t){t=!!t,this._dense!==t&&(this._dense=t,this._adapter.toggleHostAttribute(n.attributes.DENSE,t))}}class q extends T{constructor(t){super(t),this._rootElement=l(this._component,n.selectors.ROOT),this._focusIndicatorElement=l(this._component,y.elementName),this._stateLayerElement=l(this._component,L.elementName),this._defaultSlotElement=l(this._component,n.selectors.DEFAULT_SLOT),this._endSlotElement=l(this._component,n.selectors.END_SLOT)}get hasSlottedAnchor(){return!!this.getSlottedAnchor}get getSlottedAnchor(){return this._defaultSlotElement.assignedElements({flatten:!0}).find(t=>t.tagName==="A")}initialize(){const t=this.getSlottedAnchor;this._component[h]({role:t?null:"button"},{setAttribute:!this._component.hasAttribute("role")||!!t}),this._rootElement.classList.toggle(n.classes.WITH_ANCHOR,!!t),t?this._component.removeAttribute("tabindex"):!this._component.disabled&&!this._component.hasAttribute("tabindex")&&this._component.setAttribute("tabindex","0"),this._focusIndicatorElement.targetElement=t||this._component,this._stateLayerElement.targetElement=t||this._component}setDisabled(t){t?(this._focusIndicatorElement.remove(),this._stateLayerElement.remove()):this._rootElement.append(this._focusIndicatorElement,this._stateLayerElement),this.hasSlottedAnchor?(this._component.removeAttribute("tabindex"),this._component[h]({ariaDisabled:null},{setAttribute:!0})):(t?this._component.removeAttribute("tabindex"):this._component.setAttribute("tabindex","0"),this._component[h]({ariaDisabled:t?"true":null}))}clickHost(){HTMLElement.prototype.click.call(this._component)}forceFocusVisible(){this._focusIndicatorElement.active=!0}clickFormButton(t){var s;if(this._component.form)if(t==="submit"){this._component[d].setFormValue(this._component.value);const e=document.createElement("button");e.type=t,P(this._component,e,I),this._component.form.addEventListener("submit",i=>{Object.defineProperty(i,"submitter",{configurable:!0,enumerable:!0,get:()=>this._component})},{capture:!0,once:!0}),this._component.insertAdjacentElement("afterend",e),e.click(),e.remove()}else t==="reset"&&((s=this._component.form)==null||s.reset())}hasPopoverTarget(){return this._component.hasAttribute("popovertarget")||!!this._component.popoverTargetElement}managePopover(){if(this._component.form||!this.hasPopoverTarget()||!v())return!1;const t=this._locatePopoverTargetElement();if(!t)return!1;const s=this._component.getAttribute("popovertargetaction")??this._component.popoverTargetAction??"toggle",e=t.matches(":popover-open");switch(s){case"show":return e||t.showPopover(),!0;case"hide":return e&&t.hidePopover(),!1;case"toggle":default:const i=t.togglePopover();if(i&&t.popover!=="manual"){const r=a=>{a.stopPropagation(),t.matches(":popover-open")&&t.hidePopover()};this._component.addEventListener("click",r,{capture:!0,once:!0}),t.addEventListener("beforetoggle",async()=>{await new Promise(a=>setTimeout(a)),this._component.removeEventListener("click",r,{capture:!0})},{once:!0})}return i}}toggleDefaultPopoverIcon(t){if(t){if(!this._endSlotElement.querySelector("forge-icon")){const e=document.createElement("forge-icon");e.classList.add(n.classes.POPOVER_ICON),e.name=f.name,this._endSlotElement.append(e)}}else{const s=this._endSlotElement.querySelector("forge-icon");s==null||s.remove()}}animateStateLayer(){var t;this._stateLayerElement.disabled||(t=this._stateLayerElement)==null||t.playAnimation()}addDefaultSlotChangeListener(t){this._defaultSlotElement.addEventListener("slotchange",t)}_locatePopoverTargetElement(){let t=this._component.popoverTargetElement??null;if(!t){const s=this._component.ownerDocument.getRootNode();if(!s)return null;const e=this._component.getAttribute("popovertarget");t=s.querySelector(`#${e}`)}return t}}export{W as B,R as W,q as a,c as b,n as c,w as d,N as e,O as t};
